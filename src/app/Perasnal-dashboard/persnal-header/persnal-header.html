<header class="w-full bg-white  relative">
  <div
    class="max-w-7xl mx-auto px-4 sm:px-6 flex flex-col sm:flex-row sm:items-center sm:justify-between py-3 sm:h-16 gap-3 sm:gap-0"
  >
    <div class="flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-5">
      <div class="flex items-center gap-2 justify-between sm:justify-start">
        <div
          class="w-8 h-8 rounded-full  flex items-center justify-center"
        >
        <img src="shield.png" alt="" >
        </div>
        <span class="font-semibold text-gray-800 text-lg">Escrow</span>
      </div>

      <nav class="flex flex-wrap items-center gap-3 sm:gap-4 text-sm mx-0 sm:mx-5">
        <a routerLink="/persnal-dashboard/dashboard" class="text-[#20b1ec] font-semibold">Dashboard</a>
        <a routerLink="/persnal-dashboard/support" class="text-gray-500 hover:text-[#20b1ec] transition">Support</a>
      </nav>
    </div>

    <!-- Trigger area is relative to place the popup -->
    <div class="flex justify-between sm:justify-end items-center relative">
      <button
        type="button"
        (click)="togglePopup($event)"
        class="flex items-center gap-2 px-2 py-1 rounded hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-sky-400"
        aria-haspopup="menu"
        [attr.aria-expanded]="isOpen"
      >
        <div class="w-8 h-8 bg-[#e6f7ff] rounded-full flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none"
               viewBox="0 0 24 24" stroke-width="1.8" stroke="#20b1ec"
               class="w-5 h-5">
            <path stroke-linecap="round" stroke-linejoin="round"
                  d="M12 12c2.5 0 4.5-2 4.5-4.5S14.5 3 12 3 7.5 5 7.5 7.5 9.5 12 12 12zm0 2c-3 0-9 1.5-9 4.5V21h18v-2.5c0-3-6-4.5-9-4.5z"/>
          </svg>
        </div>
        <span class="text-gray-700 text-sm font-medium hidden sm:inline">{{ user.name }}</span>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none"
             viewBox="0 0 24 24" stroke-width="2" stroke="#6b7280"
             class="w-4 h-4 hidden sm:block">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 9l6 6 6-6"/>
        </svg>
      </button>

      <!-- Popup -->
      <div
        *ngIf="isOpen"
        class="absolute right-0 top-12 z-50"
        role="menu"
        aria-label="Profile menu"
      >
        <div class="bg-white w-[380px] rounded-2xl shadow-[0_4px_25px_rgba(0,0,0,0.06)] p-6 border border-gray-100">
          <!-- Profile Info -->
          <div class="flex items-center gap-4">
            <div class="w-12 h-12 rounded-full bg-sky-100 flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-sky-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round"
                      d="M12 11c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zM4 20c0-2.67 5.33-4 8-4s8 1.33 8 4v1H4v-1z" />
              </svg>
            </div>
            <div>
              <h3 class="text-gray-900 font-semibold text-lg">{{ user.name }}</h3>
              <p class="text-gray-500 text-sm">personal account</p>
            </div>
          </div>

          <!-- Divider -->
          <div class="border-t border-gray-100 my-5"></div>

          <!-- Email -->
          <div class="space-y-2 text-sm">
            <p class="text-gray-500 font-medium">Email</p>
            <p class="text-gray-800 font-medium">{{ user.email }}</p>
          </div>

          <!-- Last Logged In -->
          <div class="mt-4 space-y-2 text-sm">
            <p class="text-gray-500 font-medium">Last Logged In</p>
            <p class="text-gray-800 font-medium">{{ user.lastLogin }}</p>
          </div>

          <!-- Buttons -->
          <div class="mt-6 space-y-3">
            <a
              routerLink="/profile"
              class="w-full border border-gray-200 rounded-lg py-2.5 text-sm font-medium flex items-center justify-center gap-2 text-gray-700 hover:bg-gray-50 transition"
              (click)="closePopup()"
              role="menuitem"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none"
                   viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
                <path stroke-linecap="round" stroke-linejoin="round"
                      d="M5.121 17.804A9 9 0 1112 21a8.963 8.963 0 01-6.879-3.196zM15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              My Profile
            </a>

            <button
              type="button"
              class="w-full border border-red-200 text-red-500 bg-red-50 rounded-lg py-2.5 text-sm font-medium flex items-center justify-center gap-2 hover:bg-red-100 transition"
              (click)="signOut()"
              role="menuitem"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 rotate-180" fill="none"
                   viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
                <path stroke-linecap="round" stroke-linejoin="round"
                      d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1m0-10V5m0 6h-1m-4 0H3" />
              </svg>
              Sign Out
            </button>
          </div>
        </div>
      </div>
      <!-- /Popup -->
    </div>
  </div>
</header>
